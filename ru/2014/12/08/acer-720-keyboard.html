<!DOCTYPE html>
<html>

  <head>
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta http-equiv="content-language" content="ru" />

  <!-- Enable responsiveness on mobile devices-->
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">

  <title>
    
      Имитация недостающих клавиш Acer C720 &middot; Yellow Rabbit
    
  </title>

  <!-- CSS -->
  <link rel="stylesheet" href="/public/css/poole.css">
  <link rel="stylesheet" href="/public/css/lanyon.css">
  <link rel="stylesheet" href="/public/css/syntax.css">

  <!-- Icons -->
  <link rel="shortcut icon" href="/public/favicon.ico">

  <!-- RSS -->
  <link rel="alternate" type="application/rss+xml" title="RSS" href="/atom.xml">
</head>


  <body>

    <!-- Target for toggling the sidebar `.sidebar-checkbox` is for regular
     styles, `#sidebar-checkbox` for behavior. -->
<input type="checkbox" class="sidebar-checkbox" id="sidebar-checkbox">

<!-- Toggleable sidebar -->
<div class="sidebar" id="sidebar">
  <div class="sidebar-item">
    <p></p>
  </div>

  <nav class="sidebar-nav">
    <a class="sidebar-nav-item" href="/">Home</a>

    

    
    
      
        
      
    
      
        
      
    
      
        
          <a class="sidebar-nav-item" href="/about.html">About</a>
        
      
    
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    
      
        
      
    

    <span class="sidebar-nav-item">Currently v1.0.1</span>
  </nav>

  <div class="sidebar-item">
    <p>
      &copy; 2016. All rights reserved.
    </p>
  </div>
</div>


    <!-- Wrap is the content to shift when toggling the sidebar. We wrap the
         content to avoid any CSS collisions with our real content. -->
    <div class="wrap">
      <div class="masthead">
        <div class="container">
          <h3 class="masthead-title">
		  <a href="/" title="Home">Yellow Rabbit</a>
            <small>не забывает играть</small>
          </h3>
        </div>
      </div>

      <div class="container content">
        <div class="post">
  <h1 class="post-title">Имитация недостающих клавиш Acer C720</h1>
    <div class="post-meta">08 Dec 2014
	<ul class="tag_list_in_post">
	
	<li class="inline tag_list_item">
		<a class="tag_list_link" href="/tag/xorg"> xorg</a>
	</li>
	
	<li class="inline tag_list_item">
		<a class="tag_list_link" href="/tag/c720"> c720</a>
	</li>
	
	</ul>
    </div>
  <p>Клавиатура хромбука Acer C720 видимо хороша для прогулок по сети и работы в Chrome OS, но мне для написания программ некоторых клавиш не хватает. Это <em>Home</em>, <em>End</em>, <em>PageUp</em>, <em>PageDown</em>, <em>Insert</em> и <em>Delete</em>.</p>

<p>Можно попробовать использовать клавишу <em>Alt</em> (генерирует символ Alt) как модификатор для курсорных клавиш. Тогда получаются следующие клавиатурные комбинации:</p>

<table align="center" style="width:60%;align=center">
	<tr>
		<th>Клавиша</th><th>Комбинация</th>
	</tr>
	<tr>
		<td>Insert</td><td>Alt + \</td>
	</tr>
	<tr>
		<td>Delete</td><td>Alt + BackSpace</td>
	</tr>
	<tr>
		<td>Home</td><td>Alt + Left (&larr;)</td>
	</tr>
	<tr>
		<td>End</td><td>Alt + Right (&rarr;)</td>
	</tr>
	<tr>
		<td>PageUp</td><td>Alt + Up (&uarr;)</td>
	</tr>
	<tr>
		<td>PageDown</td><td>Alt + Down (&darr;)</td>
	</tr>
</table>

<p>Для модификации раскладки используем <em>xkb</em>. Сначала создадим каталог для конфигурационых файлов:</p>

<figure class="highlight"><pre><code class="language-console" data-lang="console">	mkdir -p ${HOME}/.config/xkb/types ${HOME}/.config/xkb/symbols</code></pre></figure>

<p>В файле <code class="highlighter-rouge">${HOME}/.config/xkb/types/c720</code>  как будут себя вести совместно два модификатора - <em>Shift</em> и <em>Alt</em>. Интерес представляют ситуации, когда нажат <em>Alt</em>, то есть уровень 3.</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">xkb_types</span> <span class="s">"c720"</span> <span class="p">{</span>
	<span class="n">virtual_modifiers</span> <span class="n">Alt</span><span class="p">;</span>
	<span class="n">type</span> <span class="s">"ARROW"</span> <span class="p">{</span>
		<span class="n">modifiers</span>	<span class="o">=</span> <span class="n">Shift</span><span class="o">+</span><span class="n">Alt</span><span class="p">;</span>
		<span class="n">map</span><span class="p">[</span><span class="n">Shift</span><span class="p">]</span>	<span class="o">=</span> <span class="n">Level2</span><span class="p">;</span>
		<span class="n">map</span><span class="p">[</span><span class="n">Alt</span><span class="p">]</span>	<span class="o">=</span> <span class="n">Level3</span><span class="p">;</span>
		<span class="n">map</span><span class="p">[</span><span class="n">Alt</span><span class="o">+</span><span class="n">Shift</span><span class="p">]</span>	<span class="o">=</span> <span class="n">Level3</span><span class="p">;</span>
		<span class="n">level_name</span><span class="p">[</span><span class="n">Level1</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Base"</span><span class="p">;</span>
		<span class="n">level_name</span><span class="p">[</span><span class="n">Level2</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Caps"</span><span class="p">;</span>
		<span class="n">level_name</span><span class="p">[</span><span class="n">Level3</span><span class="p">]</span> <span class="o">=</span> <span class="s">"Alt"</span><span class="p">;</span>
	<span class="p">};</span>
<span class="p">};</span></code></pre></figure>

<p>В файле <code class="highlighter-rouge">${HOME}/.config/xkb/symbols/c720</code> на уровне 3 производим подмену символов клавиш на нужные и не забываем очистить флажок модификатора, иначе новые символы будут обрабатываться неверно.</p>

<figure class="highlight"><pre><code class="language-c" data-lang="c"><span class="n">xkb_symbols</span> <span class="s">"c720"</span> <span class="p">{</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">BKSL</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="n">repeat</span><span class="o">=</span><span class="n">yes</span><span class="p">,</span>
		<span class="n">symbol</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">backslash</span><span class="p">,</span> <span class="n">bar</span><span class="p">,</span> <span class="n">Insert</span><span class="p">],</span>
		<span class="n">symbol</span><span class="p">[</span><span class="n">Group2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">backslash</span><span class="p">,</span> <span class="n">slash</span><span class="p">,</span> <span class="n">Insert</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">INS</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">INS</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">BKSP</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="n">repeat</span><span class="o">=</span><span class="n">yes</span><span class="p">,</span>
		<span class="p">[</span><span class="n">BackSpace</span><span class="p">,</span> <span class="n">BackSpace</span><span class="p">,</span> <span class="n">Delete</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">DELE</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">LEFT</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="p">[</span><span class="n">Left</span><span class="p">,</span> <span class="n">Left</span><span class="p">,</span> <span class="n">Home</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">HOME</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">RGHT</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="n">repeat</span><span class="o">=</span><span class="n">yes</span><span class="p">,</span>
		<span class="p">[</span><span class="n">Right</span><span class="p">,</span> <span class="n">Right</span><span class="p">,</span> <span class="n">End</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">END</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">UP</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="n">repeat</span><span class="o">=</span><span class="n">yes</span><span class="p">,</span>
		<span class="p">[</span><span class="n">Up</span><span class="p">,</span> <span class="n">Up</span><span class="p">,</span> <span class="n">Prior</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">PGUP</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
	<span class="n">key</span> <span class="o">&lt;</span><span class="n">DOWN</span><span class="o">&gt;</span> <span class="p">{</span>
		<span class="n">type</span><span class="o">=</span><span class="s">"ARROW"</span><span class="p">,</span>
		<span class="p">[</span><span class="n">Down</span><span class="p">,</span> <span class="n">Down</span><span class="p">,</span> <span class="n">Next</span><span class="p">],</span>
		<span class="n">actions</span><span class="p">[</span><span class="n">Group1</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">NoAction</span><span class="p">(),</span>
			<span class="n">RedirectKey</span><span class="p">(</span><span class="n">key</span><span class="o">=&lt;</span><span class="n">PGDN</span><span class="o">&gt;</span><span class="p">,</span> <span class="n">clearmods</span><span class="o">=</span><span class="n">Alt</span><span class="p">)</span>
		<span class="p">]</span>
	<span class="p">};</span>
<span class="p">};</span></code></pre></figure>

<p>Осталось записать в .xinitrc следующую команду для загрузки изменённой раскладки:</p>

<figure class="highlight"><pre><code class="language-console" data-lang="console">setxkbmap -layout "us+c720" -types "complete+c720" -print|xkbcomp -I"$HOME/.config/xkb" - "${DISPLAY%%.*}"</code></pre></figure>


</div>

<div class="related">
  <h2>Related Posts</h2>
  <ul class="related-posts">
    
      <li>
          <a href="/ru/2016/03/27/xiaomi-android-6-wear.html">
            Xiaomi, Android 6 and Wear
            <small>27 Mar 2016</small>
          </a>
      </li>
    
      <li>
          <a href="/ru/2016/01/23/trilobyte.-simple-macros.html">
            Trilobyte. Simple macros
            <small>23 Jan 2016</small>
          </a>
      </li>
    
      <li>
          <a href="/ru/2015/12/26/trilobyte.-a-new-heuristic.html">
            Trilobyte. A new heuristic.
            <small>26 Dec 2015</small>
          </a>
      </li>
    
  </ul>
</div>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'yrabbitblog'; // required: replace example with your forum shortname
	/* var disqus_developer = 1; */

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

<!-- vim:ts=4:sw=4:sts=4
-->

      </div>
    </div>

    <label for="sidebar-checkbox" class="sidebar-toggle"></label>

    <script>
      (function(document) {
        var toggle = document.querySelector('.sidebar-toggle');
        var sidebar = document.querySelector('#sidebar');
        var checkbox = document.querySelector('#sidebar-checkbox');

        document.addEventListener('click', function(e) {
          var target = e.target;

          if(!checkbox.checked ||
             sidebar.contains(target) ||
             (target === checkbox || target === toggle)) return;

          checkbox.checked = false;
        }, false);
      })(document);
    </script>
  </body>
</html>
